# Core parameters ####################################################
# !include partials/paths_rll4_jeff.yaml
root_dir:     /home/jmahler/jeff_working/GPIS/
cache_dir:    /home/jmahler/jeff_working/GPIS/data/gcs

# DB generation params
database_dir: &id_database_dir /mnt/wd_ssd/dexnet/db
database_cache_dir: *id_database_dir
database_name: physical_experiment_test_db3.hdf5
results_database_name: results.hdf5

datasets:
  dexnet_physical_experiments:
    start_index: 0
    end_index: 100

num_prealloc_obj_samples: 10   # zero if we want to sample on-line
num_prealloc_grasp_samples: 10

ppc_stp_ids:
  bar_clamp: pose_2
  climbing_hold: pose_2
  endstop_holder: pose_2
  gearbox: pose_5
  mount1: pose_6
  mount2: pose_0
  nozzle: pose_3
  part1: pose_3
  part3: pose_4
  pawn: pose_3
  pipe_connector: pose_6
  turbine_housing: pose_1
  vase: pose_2

# Flags to grasp labelling script
sample_grasps: 0
extract_features: 0
compute_grasp_metrics: 1
write_in_place: 1
delete_existing_grasps: 0
skip_labeled_objects: 0

deterministic_metrics:
  - partial_closure

robust_metrics:
  - none
  #- ferrari_canny_L1
  #- force_closure
  #- partial_closure

physical_uncertainty:
  sigma_gripper_x: 0.005
  sigma_gripper_y: 0.005
  sigma_gripper_z: 0.00075 
  sigma_gripper_rot_x: 0.001
  sigma_gripper_rot_y: 0.001
  sigma_gripper_rot_z: 0.015
  sigma_obj_x: 0.005
  sigma_obj_y: 0.005
  sigma_obj_z: 0.00001
  sigma_obj_rot_x: 0.0001
  sigma_obj_rot_y: 0.0001
  sigma_obj_rot_z: 0.15
  sigma_scale: 0.0

low_u_mult: 0.5
high_u_mult: 2.0

# Params for partial closure
object_mass: 0.155
grasp_force_limit: 12.5
stp_min_p: 0.01

# Gripper params
grippers: 
  - zeke

# Grasp candidate params
grasp_candidate_dir: data/grasp_candidates
num_grasp_candidates: 12
approach_dist: 0.2
delta_approach: 0.01
rotate_threshold: 0.3925
table_clearance: 0.005

candidate_grasp_metrics:
  - pfc
  - efc
  - ppc
  - ferrari_canny_L1

# Grasp sampling params
target_num_grasps: 250
grasp_sampler: anti_uniform

friction_coef: 0.5
num_cone_faces: 8
max_grasp_sampling_iters: 5
max_num_surface_points: 500
min_contact_dist: 0.01
grasp_samples_per_surface_point: 2 # lower for fewer samples
num_grasp_clusters: 10

bandit_snapshot_rate: 1
use_soft_fingers: 1

vis_grasps: False
vis_delay: 0.5
check_collisions: 1

min_num_collision_free_grasps: 200

# Antipodal Sampling Params
dir_prior: 1.0
alpha_thresh_div: 8.0 # in multiples of pi
num_grasp_rots: 20  # in multiples of pi
rho_thresh: 0.75 # as percentage of object max moment
alpha_inc: 0.25
rho_inc: 0.025
friction_inc: 0.1

# Uncertainty
sigma_mu: 0.1
sigma_trans_grasp: 0.005
sigma_rot_grasp: 0.1
sigma_trans_obj: 0.005
sigma_rot_obj: 0.1
sigma_scale_obj: 0.025

grasp_symmetry: True

# Labellling params
min_dim: 0.09
sdf_dim: 50
sdf_padding: 5
density: 2000.0
gripper_size: 0.1
mass_thresh: 0.01
default_mass: 1.0
pfc_num_samples: 100
ppc_num_samples: 25
pfc_compute_variance: true
eq_num_samples: 100

# Plotting params
alpha: 0.05
center_scale: 0.0075
tube_radius: 0.0025
table_extent: 0.5
num_grasp_views: 8
cam_dist: 1.00

dataset_counts: data/counts.txt
num_trials: 0
sleep_time: 10

priors_dataset: keys_10000_train_and_val
priors_feature_names:
  - nearest_features_1000_train_and_val

# GCE parameters #####################################################
client_secrets: &id_client_secrets client_secrets.json
oauth_storage:  &id_oauth_storage  oauth2.dat
disk_type:      &id_disk_type      PERSISTENT
num_processes: 8
project:        nth-clone-620
bucket:          dex-net-results-2 # TODO
compute:
  project:        &id_project        nth-clone-620
  bucket:         &id_bucket         dex-net-results-2 # TODO
  api_version:    v1
  machine_type:   n1-standard-1
  disk_size_gb: 2048
  zones:
    - asia-east1-a
    - us-central1-a
    - europe-west1-b
  instance_quota: 200
  startup_script: scripts/cm_startup.sh # TODO
  image_project:  *id_project
  image:          dex-net-image
  data_disks:
    - dex-net-data-2-big-asia
    - dex-net-data-2-big
    - dex-net-data-2-big-europe
  service_email:  default
  network:        default
  run_script:     src/grasp_selection/correlated_bandits_priors.py
  results_script: src/grasp_selection/compile_bandit_prior_results.py
  update_script: src/grasp_selection/compile_bandit_prior_results.py
  scopes:
    - https://www.googleapis.com/auth/compute
    - https://www.googleapis.com/auth/devstorage.full_control
    - https://www.googleapis.com/auth/devstorage.read_only
    - https://www.googleapis.com/auth/devstorage.read_write

# Notification parameters ############################################
gmail_user:     &id_gmail_user      RavenDebridement
gmail_password: &id_gmail_password  surgicallab
notify_email:   &id_notify_email    jmahl42@gmail.com
